Note: We can use it as a template also

Create Project:

    poetry new auth-server

Change directory to project:

    cd auth-server 

Add dependecies in pyproject.toml file and run following command:

    poetry install

Add poetry virtualenv interpreter in VSCode make a file main.py in todo_app folder

Write main.py
write settings.py
write models.py

Create a Neon Database Project and copy the connection string and paste it to .env file (check .env_back sample):

.env 
DATABASE_URL = neon database connection string 
TEST_DATABASE_URL = neon database test connection string 



https://neon.tech/docs/guides/python#create-a-neon-project

Create a Neon Database Project Test Branch and copy the connection string and paste it to .env file (check .env_back sample):

test_main.py

https://neon.tech/docs/manage/branches#create-a-branch



Run test:

    poetry run pytest

Run project in Poetry Envirnoment:

    poetry run uvicorn auth_server.main:app --host 127.0.0.1 --port 8000 --reload

Open in Browser:

    http://127.0.0.1:8000/

    http://127.0.0.1:8000/docs

    http://127.0.0.1:8000/openapi.json

## python console application
make a file:
    python_console_client.py
run command:
   poetry run python python_console_client.py  

## Publish on the Web while running locally

Install Ngrok:

https://ngrok.com/docs/getting-started/

Run the following command to add your authtoken to the default ngrok.yml:

    ngrok config add-authtoken 2bZGNZ3Mj3HdRxPt19defOl_7oFHsvr5AmM9A9UZUyhFn

Deploy with your static domain:

    ngrok http --domain=my-static-domain.ngrok-free.app 8000

Open in Browser:

    https://my-static-domain.ngrok-free.app/

Open in Browser:

    https://my-static-domain.ngrok-free.app/

Open Docs in Browser:

    https://my-static-domain.ngrok-free.app/docs

Open OpenAPI specs in Browser:

    https://my-static-domain.ngrok-free.app/openapi.json

Now we will use this json to create GPT Action.

Now create a Custom GPT here:

    https://chat.openai.com/gpts

Add the following server url in the openapi.json file generated by FastAPI and paste it into action schema:

    "servers": [
        {
        "url": "https://my-static-domain.ngrok-free.app/"
        }
    ],

#### Now Let's Containerize the App
https://fastapi.tiangolo.com/deployment/docker/

create a Dockerfile.dev in route directory

Checking to see if Docker is running:

    docker version

run hello_world for docker in cmd
    
    docker run hello-world (for conformation if you want)

Building the Image for Dev:

    docker build -f Dockerfile.dev -t dev-auth:v.0.1 .

Check Images:

    docker images

verify config

    docker inspect dev-auth:v.0.1

Running the Container for Dev:

    docker run -d --name auth-cont1 -p 8000:8000 dev-auth:v.0.1

check container is running 

    docker ps

check all containers 

    docker ps -a 

check container logs 

    docker logs <containerName>

check container logs in live mode 
    docker logs <containerName> -f    (-f mean follow live logs)

stop container 

    docker stop <containerName or id>
    docker kill <containerId or name>

remove docker container  
    docker rm <containerName or id>

restart container 
    docker start <container Id or name>
      
Test the Container
    docker run -it --rm dev-auth:v.0.1 /bin/bash -c "poetry run pytest"

